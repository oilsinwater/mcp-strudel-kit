# Test Design: Story 1.1

Date: 2025-10-14
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 8
- Unit tests: 3 (37.5%)
- Integration tests: 4 (50%)
- E2E tests: 1 (12.5%)
- Priority distribution: P0: 3, P1: 4, P2: 1, P3: 0

## Test Scenarios by Acceptance Criteria

### AC1: Repository structure scaffolding

#### Scenarios

| ID          | Level       | Priority | Test                                                                                        | Justification                                                                                                      |
| ----------- | ----------- | -------- | ------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ |
| 1.1-INT-001 | Integration | P1       | Validate that `src/`, `tests/`, `config/`, and `.agents/` directories exist after bootstrap | File system structure is a multi-component concern (tooling + node fs); ensures architecture blueprint compliance. |

### AC2: Package configuration completeness

#### Scenarios

| ID           | Level | Priority | Test                                                                                                                                 | Justification                                                                                                       |
| ------------ | ----- | -------- | ------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------- |
| 1.1-UNIT-001 | Unit  | P0       | Parse `package.json` to confirm metadata, engines (Node ≥18), xmcp dependency, and required scripts (`dev`, `build`, `lint`, `test`) | Pure JSON validation without side effects; guards critical tooling alignment and mitigates tooling complexity risk. |

### AC3: TypeScript configuration strictness

#### Scenarios

| ID           | Level       | Priority | Test                                                                                                   | Justification                                                                                                    |
| ------------ | ----------- | -------- | ------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------- |
| 1.1-UNIT-002 | Unit        | P0       | Assert `tsconfig.json` enables `strict`, targets ≥ES2020, and defines path aliases for `@/` namespaces | Static config inspection is deterministic logic best handled at unit level.                                      |
| 1.1-INT-002  | Integration | P0       | Execute `tsc --noEmit` against workspace configs to ensure project compiles without diagnostics        | Runs compiler over real sources to catch cross-file issues; defends against xmcp/TypeScript compatibility risks. |

### AC4: Code quality tooling integration

#### Scenarios

| ID          | Level       | Priority | Test                                                                                                | Justification                                                                                                |
| ----------- | ----------- | -------- | --------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------ |
| 1.1-INT-003 | Integration | P1       | Run Husky + lint-staged dry-run to confirm staged TypeScript files trigger ESLint + Prettier checks | Hooks execute through git tooling and scripting layers; integration level validates the workflow end to end. |

### AC5: Development workflow readiness

#### Scenarios

| ID           | Level       | Priority | Test                                                                                                          | Justification                                                                                                    |
| ------------ | ----------- | -------- | ------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------- |
| 1.1-INT-004  | Integration | P1       | Invoke `bootstrapEnvironment()` and `createServer()` to ensure startup succeeds without side effects          | Exercises initialization across modules, verifying environment loading and placeholder server bootstrap.         |
| 1.1-E2E-001  | E2E         | P1       | Smoke-run `npm run lint && npm run test && npm run build` on a clean checkout                                 | Represents developer entry workflow; end-to-end coverage of the critical local dev lifecycle.                    |
| 1.1-UNIT-003 | Unit        | P2       | Parse `.env.example` to ensure required keys (PORT, HOT_RELOAD_ENABLED, LOG_LEVEL, TOOL paths) are documented | Pure configuration validation; lower priority but improves onboarding and prevents environment misconfiguration. |

## Risk Coverage

| Risk ID       | Description                                           | Mitigated By                           |
| ------------- | ----------------------------------------------------- | -------------------------------------- |
| RISK-TEC-001  | xmcp compatibility with Node/TypeScript versions      | 1.1-INT-002, 1.1-E2E-001               |
| RISK-TEC-002  | Tooling stack complexity causing setup failures       | 1.1-UNIT-001, 1.1-INT-003, 1.1-E2E-001 |
| RISK-QUAL-001 | Developer onboarding friction due to missing docs/env | 1.1-INT-001, 1.1-UNIT-003              |

## Recommended Execution Order

1. P0 unit tests (1.1-UNIT-001, 1.1-UNIT-002)
2. P0 integration test (1.1-INT-002)
3. P1 integration tests (1.1-INT-001, 1.1-INT-003, 1.1-INT-004)
4. P1 E2E test (1.1-E2E-001)
5. P2 unit test (1.1-UNIT-003)
